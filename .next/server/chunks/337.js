exports.id=337,exports.ids=[337],exports.modules={87529:()=>{},43895:(e,t,r)=>{"use strict";r.d(t,{k:()=>d});var n=r(94624),o=r.n(n),i=r(92048),s=r(55315);let a=process.env.LOG_FILE||(0,s.join)(process.cwd(),"data","bot.log"),c=process.env.LOG_LEVEL||"info",l=(0,s.dirname)(a);(0,i.existsSync)(l)||(0,i.mkdirSync)(l,{recursive:!0});let d=o().createLogger({level:c,format:o().format.combine(o().format.timestamp({format:"YYYY-MM-DD HH:mm:ss.SSS"}),o().format.printf(({timestamp:e,level:t,message:r,...n})=>{let o=Object.keys(n).length?` ${JSON.stringify(n)}`:"";return`[${e}] ${t.toUpperCase()}: ${r}${o}`})),transports:[new(o()).transports.Console({format:o().format.combine(o().format.colorize(),o().format.timestamp({format:"HH:mm:ss"}),o().format.printf(({timestamp:e,level:t,message:r})=>`[${e}] ${t}: ${r}`))}),new(o()).transports.File({filename:a,maxsize:10485760,maxFiles:5})]})},21925:(e,t,r)=>{"use strict";r.d(t,{EG:()=>S,L4:()=>m,YX:()=>p,_e:()=>A,pQ:()=>k,tS:()=>f});var n=r(32101),o=r(72019),i=r(78165),s=r(63813),a=r(24263),c=r(43895);a.Z.defaults.headers.common["User-Agent"]="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36",a.Z.defaults.headers.common.Accept="application/json, text/plain, */*",a.Z.defaults.headers.common["Accept-Language"]="en-US,en;q=0.9";let l=null,d=null,u=process.env.POLYGON_RPC_URL||"https://polygon-rpc.com";async function f(){if(l)return l;let e=process.env.PRIVATE_KEY,t=process.env.FUNDER_ADDRESS,r=process.env.CLOB_API_URL||"https://clob.polymarket.com",o=parseInt(process.env.CHAIN_ID||"137"),a=parseInt(process.env.SIGNATURE_TYPE||"0");if(!e||!t)return c.k.warn("No PRIVATE_KEY or FUNDER_ADDRESS set â€” live trading unavailable"),null;try{let f=new s.c(u,137),p=new i.w5(e,f),m=process.env.CLOB_API_KEY,S=process.env.CLOB_SECRET,k=process.env.CLOB_PASSPHRASE;if(m&&S&&k)d={key:m,secret:S,passphrase:k},c.k.info("Using pre-configured CLOB API keys from .env");else{let e=new n.R(r,o,p,void 0,a,t);d=await e.createOrDeriveApiKey(),c.k.info("API keys derived from Polymarket")}return l=new n.R(r,o,p,d,a,t),c.k.info("CLOB client initialized successfully"),l}catch(e){return c.k.error(`Failed to initialize CLOB client: ${e}`),null}}function p(){let e=process.env.CLOB_API_URL||"https://clob.polymarket.com",t=parseInt(process.env.CHAIN_ID||"137");return new n.R(e,t)}async function m(e,t,r,n,i){let s=await f();if(!s)return{success:!1,error:"CLOB client not initialized"};try{let a=await s.createAndPostOrder({tokenID:e,price:t,side:o.MF.BUY,size:r,feeRateBps:void 0,nonce:void 0,expiration:void 0},{tickSize:n,negRisk:i});return c.k.info(`Buy order placed: ${r} shares @ $${t} | token=${e}`),{success:!0,orderId:a?.orderID||a?.orderIds?.[0]||"unknown"}}catch(t){let e=t instanceof Error?t.message:String(t);return c.k.error(`Buy order failed: ${e}`),{success:!1,error:e}}}async function S(e,t,r,n,i){let s=await f();if(!s)return{success:!1,error:"CLOB client not initialized"};try{let a=await s.createAndPostOrder({tokenID:e,price:t,side:o.MF.SELL,size:r,feeRateBps:void 0,nonce:void 0,expiration:void 0},{tickSize:n,negRisk:i});return c.k.info(`Sell order placed: ${r} shares @ $${t} | token=${e}`),{success:!0,orderId:a?.orderID||a?.orderIds?.[0]||"unknown"}}catch(t){let e=t instanceof Error?t.message:String(t);return c.k.error(`Sell order failed: ${e}`),{success:!1,error:e}}}async function k(e,t,r,n,i){let s=await f();if(!s)return{success:!1,error:"CLOB client not initialized"};try{let a=await s.createAndPostOrder({tokenID:e,price:t,side:o.MF.BUY,size:r,feeRateBps:void 0,nonce:void 0,expiration:void 0},{tickSize:n,negRisk:i},o.mr.GTC,!1,!0);return c.k.info(`[ARB] Limit buy placed: ${r.toFixed(2)} shares @ $${t} | token=${e}`),{success:!0,orderId:a?.orderID||a?.orderIds?.[0]||"unknown"}}catch(t){let e=t instanceof Error?t.message:String(t);return c.k.error(`[ARB] Limit buy failed: ${e}`),{success:!1,error:e}}}async function A(e){let t=await f();if(!t)return{success:!1,error:"CLOB client not initialized"};try{return await t.cancelOrders(e),c.k.info(`[ARB] Cancelled ${e.length} orders`),{success:!0}}catch(t){let e=t instanceof Error?t.message:String(t);return c.k.error(`[ARB] Batch cancel failed: ${e}`),{success:!1,error:e}}}},24979:(e,t,r)=>{"use strict";r.d(t,{$2:()=>E,E3:()=>w,bp:()=>h,rs:()=>$,up:()=>y});var n=r(35240),o=r.n(n),i=r(21925),s=r(43895),a=r(72019);async function c(e,t,r=3){for(let n=0;n<r;n++)try{return await function(e,t){let r=new URLSearchParams(t).toString(),n=`${e}?${r}`;return new Promise((e,t)=>{let r=o().get({hostname:"gamma-api.polymarket.com",path:n,headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36",Accept:"application/json, text/plain, */*","Accept-Language":"en-US,en;q=0.9"},ciphers:"TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-RSA-AES128-SHA:ECDHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA:AES256-SHA",ecdhCurve:"prime256v1:secp384r1",secureProtocol:"TLSv1_2_method",timeout:1e4},r=>{if(r.statusCode&&r.statusCode>=400){let e=Error(`${r.statusCode} ${r.statusMessage}`);e.status=r.statusCode,r.resume(),t(e);return}let n="";r.on("data",e=>n+=e),r.on("end",()=>{try{e(JSON.parse(n))}catch(e){t(e)}})});r.on("error",t),r.on("timeout",()=>{r.destroy(),t(Error("timeout"))})})}(e,t)}catch(a){if(n===r-1)throw a;let o=a.status;if(o&&o>=400&&o<500&&429!==o)throw a;let i=Math.min(1e3*Math.pow(2,n),8e3);s.k.warn(`[Scanner] ${e}?${new URLSearchParams(t)} failed (attempt ${n+1}/${r}), retrying in ${i}ms`),await new Promise(e=>setTimeout(e,i))}throw Error("Unreachable")}let l={BTC:"btc",ETH:"eth",SOL:"sol",XRP:"xrp"},d=new Map,u=new Map,f=0,p=[];async function m(e,t){let r=`${l[e]}-updown-15m-${t}`;try{let n=await c("/markets",{slug:r});if(!n||!Array.isArray(n)||0===n.length)return null;let o=n[0],i=o.clobTokenIds?"string"==typeof o.clobTokenIds?JSON.parse(o.clobTokenIds):o.clobTokenIds:[];if(i.length<2)return null;return{conditionId:o.conditionId,slug:o.slug||r,question:o.question||`${e} 15m candle`,yesTokenId:i[0],noTokenId:i[1],endDate:o.endDate||o.endDateIso||"",endTimestamp:o.endDate?new Date(o.endDate).getTime()/1e3:t+900,active:!1!==o.active&&!o.closed,tickSize:o.orderPriceMinTickSize||"0.01",negRisk:!0===o.negRisk,asset:e}}catch(r){return s.k.error(`[Scanner] fetchMarket(${e}, ${t}) failed: ${r.message||r}`),null}}async function S(e,t=2){for(let r=0;r<=t;r++)try{let t=(0,i.YX)(),r=await t.getMidpoints([{token_id:e.yesTokenId,side:a.MF.BUY},{token_id:e.noTokenId,side:a.MF.BUY}]),n=parseFloat(r?.[e.yesTokenId]||"0.5"),o=parseFloat(r?.[e.noTokenId]||"0.5");return{yesPrice:n,noPrice:o}}catch(o){let n=o instanceof Error?o.message:String(o);if(r<t){let t=1e3*Math.pow(2,r);s.k.warn(`[Scanner] fetchPrices(${e.slug}) attempt ${r+1} failed: ${n}, retrying in ${t}ms`),await new Promise(e=>setTimeout(e,t))}else s.k.error(`[Scanner] fetchPrices(${e.slug}) failed after ${t+1} attempts: ${n}`)}return null}async function k(e){let{current:t,prev:r}=function(){let e=900*Math.floor(Math.floor(Date.now()/1e3)/900);return{current:e,prev:e-900}}();await Promise.all(e.map(async e=>{for(let n of[t,r]){let t=await m(e,n);if(!t||!t.active)continue;let r=await S(t),o=Math.max(0,n+900-Math.floor(Date.now()/1e3));if(r&&o>0){let n={asset:e,conditionId:t.conditionId,slug:t.slug,yesTokenId:t.yesTokenId,noTokenId:t.noTokenId,yesPrice:r.yesPrice,noPrice:r.noPrice,combinedCost:r.yesPrice+r.noPrice,secondsRemaining:o,market:t,tickSize:t.tickSize,negRisk:t.negRisk};d.set(e,n);break}}}));let n=Date.now(),o=JSON.stringify(e)!==JSON.stringify(p);(n-f>5e3||o)&&(f=n,p=[...e],A(e).catch(()=>{}))}async function A(e){let t=900*Math.floor(Math.floor(Date.now()/1e3)/900),r=[];for(let n of e){let e=l[n];for(let n=1;n<=10;n++){let o=t-900*n,i=`${e}-updown-15m-${o}`,s=u.get(i);s&&"pending"!==s.result||r.push((async()=>{try{let e=await g(i),t=new Date((o+900)*1e3);u.set(i,{slug:i,timestamp:o,result:e,endTime:t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})}catch{}})())}}await Promise.all(r)}async function g(e){try{let t=await c("/markets",{slug:e},2);if(!t?.[0])return"pending";let r=t[0];if(!0===r.active&&!r.closed)return"pending";if(r.outcomePrices)try{let e;if("string"==typeof r.outcomePrices)try{let t=JSON.parse(r.outcomePrices);e=Array.isArray(t)?t.map(Number):r.outcomePrices.split(",").map(Number)}catch{e=r.outcomePrices.split(",").map(Number)}else e=Array.isArray(r.outcomePrices)?r.outcomePrices.map(Number):[];if(e.length>=2&&!e.some(isNaN)){if(e[0]>e[1])return"up";if(e[1]>e[0])return"down"}}catch{}let n=r.clobTokenIds?"string"==typeof r.clobTokenIds?JSON.parse(r.clobTokenIds):r.clobTokenIds:[];if(n.length>=2)try{let e=(0,i.YX)(),t=await e.getMidpoints([{token_id:n[0],side:a.MF.BUY},{token_id:n[1],side:a.MF.BUY}]),r=parseFloat(t?.[n[0]]||"0"),o=parseFloat(t?.[n[1]]||"0");if(r>.9)return"up";if(o>.9)return"down"}catch{}return"pending"}catch{return"pending"}}function h(e){let t=900*Math.floor(Math.floor(Date.now()/1e3)/900),r=[],n=e&&e.length>0?e.map(e=>l[e]):Object.values(l);for(let e=1;e<=10;e++){let o=t-900*e;for(let e of n){let t=`${e}-updown-15m-${o}`,n=u.get(t);if(n){r.push(n);break}}}return r}function y(e){k(e).catch(e=>{s.k.error(`[Scanner] Initial scan failed: ${e}`)}),setInterval(()=>{k(e).catch(e=>{s.k.error(`[Scanner] Scan failed: ${e}`)})},5e3),s.k.info(`[Scanner] Started for assets: ${e.join(", ")}`)}function w(e,t){let r=u.get(e);if(r)r.result=t;else{let r=parseInt(e.split("-").pop()||"0",10),n=new Date((r+900)*1e3);u.set(e,{slug:e,timestamp:r,result:t,endTime:n.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})}}function E(){let e=Math.floor(Date.now()/1e3);return Array.from(d.values()).map(t=>{let r=parseInt(t.slug.split("-").pop()||"0",10);return{...t,secondsRemaining:Math.max(0,r+900-e)}})}function $(e){return d.get(e)||null}}};