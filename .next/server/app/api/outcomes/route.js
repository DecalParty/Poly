"use strict";(()=>{var e={};e.id=529,e.ids=[529],e.modules={12792:e=>{e.exports=require("@ethersproject/contracts")},90399:e=>{e.exports=require("@ethersproject/providers")},47152:e=>{e.exports=require("@ethersproject/wallet")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},80470:e=>{e.exports=require("sql.js")},78893:e=>{e.exports=require("buffer")},17702:e=>{e.exports=require("events")},92048:e=>{e.exports=require("fs")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},19801:e=>{e.exports=require("os")},55315:e=>{e.exports=require("path")},76162:e=>{e.exports=require("stream")},74026:e=>{e.exports=require("string_decoder")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},67332:e=>{e.exports=import("@polymarket/clob-client")},99648:e=>{e.exports=import("axios")},44665:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>l,requestAsyncStorage:()=>p,routeModule:()=>u,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d});var o=r(49303),a=r(88716),i=r(60670),s=r(34287),c=e([s]);s=(c.then?(await c)():c)[0];let u=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/outcomes/route",pathname:"/api/outcomes",filename:"route",bundlePath:"app/api/outcomes/route"},resolvedPagePath:"C:\\Users\\Vilez\\Desktop\\Poly\\polymarket-bot\\src\\app\\api\\outcomes\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:p,staticGenerationAsyncStorage:d,serverHooks:m}=u,f="/api/outcomes/route";function l(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:d})}n()}catch(e){n(e)}})},34287:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{GET:()=>c,dynamic:()=>l});var o=r(24979),a=r(3412),i=r(87070),s=e([o]);o=(s.then?(await s)():s)[0];let l="force-dynamic";async function c(){try{let e=(0,a.Gw)(),t=(0,o.bp)(e.enabledAssets);return i.NextResponse.json({success:!0,data:t})}catch(e){return i.NextResponse.json({success:!1,error:String(e)},{status:500})}}n()}catch(e){n(e)}})},24979:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{$2:()=>k,E3:()=>y,bp:()=>g,rs:()=>w,up:()=>A});var o=r(35240),a=r.n(o),i=r(21925),s=r(43895),c=r(67332),l=e([i,c]);async function u(e,t,r=3){for(let n=0;n<r;n++)try{return await function(e,t){let r=new URLSearchParams(t).toString(),n=`${e}?${r}`;return new Promise((e,t)=>{let r=a().get({hostname:"gamma-api.polymarket.com",path:n,headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36",Accept:"application/json, text/plain, */*","Accept-Language":"en-US,en;q=0.9"},ciphers:"TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-RSA-AES128-SHA:ECDHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA:AES256-SHA",ecdhCurve:"prime256v1:secp384r1",minVersion:"TLSv1.2",maxVersion:"TLSv1.3",timeout:1e4},r=>{if(r.statusCode&&r.statusCode>=400){let e=Error(`${r.statusCode} ${r.statusMessage}`);e.status=r.statusCode,r.resume(),t(e);return}let n="";r.on("data",e=>n+=e),r.on("end",()=>{try{e(JSON.parse(n))}catch(e){t(e)}})});r.on("error",t),r.on("timeout",()=>{r.destroy(),t(Error("timeout"))})})}(e,t)}catch(i){if(n===r-1)throw i;let o=i.status;if(o&&o>=400&&o<500&&429!==o)throw i;let a=Math.min(1e3*Math.pow(2,n),8e3);s.k.warn(`[Scanner] ${e}?${new URLSearchParams(t)} failed (attempt ${n+1}/${r}), retrying in ${a}ms`),await new Promise(e=>setTimeout(e,a))}throw Error("Unreachable")}[i,c]=l.then?(await l)():l;let E={BTC:"btc",ETH:"eth",SOL:"sol",XRP:"xrp"},T=new Map,C=new Map,x=new Map,M=0,H=[];function p(e){let t=Math.floor(Date.now()/1e3);return Math.max(0,e+900-t)}async function d(e,t){let r=`${E[e]}-updown-15m-${t}`;try{let n=await u("/markets",{slug:r});if(!n||!Array.isArray(n)||0===n.length)return null;let o=n[0],a=o.clobTokenIds?"string"==typeof o.clobTokenIds?JSON.parse(o.clobTokenIds):o.clobTokenIds:[];if(a.length<2)return null;return{conditionId:o.conditionId,slug:o.slug||r,question:o.question||`${e} 15m candle`,yesTokenId:a[0],noTokenId:a[1],endDate:o.endDate||o.endDateIso||"",endTimestamp:o.endDate?new Date(o.endDate).getTime()/1e3:t+900,active:!1!==o.active&&!o.closed,tickSize:o.orderPriceMinTickSize||"0.01",negRisk:!0===o.negRisk,asset:e}}catch(r){return s.k.error(`[Scanner] fetchMarket(${e}, ${t}) failed: ${r.message||r}`),null}}async function m(e){let{current:t,prev:r}=function(){let e=Math.floor(Date.now()/1e3),t=900*Math.floor(e/900);return{current:t,prev:t-900}}();await Promise.all(e.map(async e=>{let n=C.get(e);if(!n||n.windowTs!==t)for(let n of[t,r]){let r=await d(e,n);if(r&&r.active){C.set(e,{market:r,windowTs:t});break}}})),await f(e);let n=Date.now(),o=JSON.stringify(e)!==JSON.stringify(H);(n-M>5e3||o)&&(M=n,H=[...e],S(e).catch(()=>{}))}async function f(e){let t=[],r=[];for(let n of e){let e=C.get(n);if(!e)continue;let{market:o}=e;o.active&&(0>=p(parseInt(o.slug.split("-").pop()||"0",10))||(t.push({asset:n,market:o}),r.push({token_id:o.yesTokenId,side:c.Side.BUY},{token_id:o.noTokenId,side:c.Side.BUY})))}if(0!==r.length)try{let e=(0,i.YX)(),n=await e.getMidpoints(r);for(let{asset:e,market:r}of t){let t=parseFloat(n?.[r.yesTokenId]||"0.5"),o=parseFloat(n?.[r.noTokenId]||"0.5"),a=parseInt(r.slug.split("-").pop()||"0",10),i=p(a);if(i>0){let n={asset:e,conditionId:r.conditionId,slug:r.slug,yesTokenId:r.yesTokenId,noTokenId:r.noTokenId,yesPrice:t,noPrice:o,combinedCost:t+o,secondsRemaining:i,market:r,tickSize:r.tickSize,negRisk:r.negRisk};T.set(e,n)}}}catch(t){let e=t instanceof Error?t.message:String(t);s.k.warn(`[Scanner] Batched price poll failed: ${e}`)}}async function S(e){let t=Math.floor(Date.now()/1e3),r=900*Math.floor(t/900),n=[];for(let t of e){let e=E[t];for(let t=1;t<=10;t++){let o=r-900*t,a=`${e}-updown-15m-${o}`,i=x.get(a);i&&"pending"!==i.result||n.push((async()=>{try{let e=await h(a),t=new Date((o+900)*1e3);x.set(a,{slug:a,timestamp:o,result:e,endTime:t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})}catch{}})())}}await Promise.all(n)}async function h(e){try{let t=await u("/markets",{slug:e},2);if(!t?.[0])return"pending";let r=t[0];if(!0===r.active&&!r.closed)return"pending";if(r.outcomePrices)try{let e;if("string"==typeof r.outcomePrices)try{let t=JSON.parse(r.outcomePrices);e=Array.isArray(t)?t.map(Number):r.outcomePrices.split(",").map(Number)}catch{e=r.outcomePrices.split(",").map(Number)}else e=Array.isArray(r.outcomePrices)?r.outcomePrices.map(Number):[];if(e.length>=2&&!e.some(isNaN)){if(e[0]>e[1])return"up";if(e[1]>e[0])return"down"}}catch{}let n=r.clobTokenIds?"string"==typeof r.clobTokenIds?JSON.parse(r.clobTokenIds):r.clobTokenIds:[];if(n.length>=2)try{let e=(0,i.YX)(),t=await e.getMidpoints([{token_id:n[0],side:c.Side.BUY},{token_id:n[1],side:c.Side.BUY}]),r=parseFloat(t?.[n[0]]||"0"),o=parseFloat(t?.[n[1]]||"0");if(r>.9)return"up";if(o>.9)return"down"}catch{}return"pending"}catch{return"pending"}}function g(e){let t=Math.floor(Date.now()/1e3),r=900*Math.floor(t/900),n=[],o=e&&e.length>0?e.map(e=>E[e]):Object.values(E);for(let e=1;e<=10;e++){let t=r-900*e;for(let e of o){let r=`${e}-updown-15m-${t}`,o=x.get(r);if(o){n.push(o);break}}}return n}function A(e){m(e).catch(e=>{s.k.error(`[Scanner] Initial scan failed: ${e}`)}),setInterval(()=>{m(e).catch(e=>{s.k.error(`[Scanner] Scan failed: ${e}`)})},3e4),setInterval(()=>{f(e).catch(e=>{s.k.error(`[Scanner] Price poll failed: ${e}`)})},1e3),s.k.info(`[Scanner] Started for assets: ${e.join(", ")}`)}function y(e,t){let r=x.get(e);if(r)r.result=t;else{let r=parseInt(e.split("-").pop()||"0",10),n=new Date((r+900)*1e3);x.set(e,{slug:e,timestamp:r,result:t,endTime:n.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})}}function k(){let e=Math.floor(Date.now()/1e3);return Array.from(T.values()).map(t=>{let r=parseInt(t.slug.split("-").pop()||"0",10);return{...t,secondsRemaining:Math.max(0,r+900-e)}})}function w(e){return T.get(e)||null}n()}catch(e){n(e)}})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[948,327,70,624,558,925],()=>r(44665));module.exports=n})();