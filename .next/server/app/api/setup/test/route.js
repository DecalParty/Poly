"use strict";(()=>{var e={};e.id=83,e.ids=[83],e.modules={12792:e=>{e.exports=require("@ethersproject/contracts")},90399:e=>{e.exports=require("@ethersproject/providers")},47152:e=>{e.exports=require("@ethersproject/wallet")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},17702:e=>{e.exports=require("events")},92048:e=>{e.exports=require("fs")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},19801:e=>{e.exports=require("os")},55315:e=>{e.exports=require("path")},76162:e=>{e.exports=require("stream")},74026:e=>{e.exports=require("string_decoder")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},67332:e=>{e.exports=import("@polymarket/clob-client")},99648:e=>{e.exports=import("axios")},37097:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.r(t),r.d(t,{originalPathname:()=>m,patchFetch:()=>c,requestAsyncStorage:()=>p,routeModule:()=>d,serverHooks:()=>A,staticGenerationAsyncStorage:()=>u});var a=r(49303),n=r(88716),s=r(60670),i=r(34722),l=e([i]);i=(l.then?(await l)():l)[0];let d=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/setup/test/route",pathname:"/api/setup/test",filename:"route",bundlePath:"app/api/setup/test/route"},resolvedPagePath:"C:\\Users\\Vilez\\Desktop\\Poly\\polymarket-bot\\src\\app\\api\\setup\\test\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:p,staticGenerationAsyncStorage:u,serverHooks:A}=d,m="/api/setup/test/route";function c(){return(0,s.patchFetch)({serverHooks:A,staticGenerationAsyncStorage:u})}o()}catch(e){o(e)}})},49303:(e,t,r)=>{e.exports=r(30517)},34722:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.r(t),r.d(t,{GET:()=>c,dynamic:()=>d});var a=r(87070),n=r(21925),s=r(90399),i=r(47152),l=e([n]);n=(l.then?(await l)():l)[0];let d="force-dynamic";async function c(){let e={},t=process.env.PRIVATE_KEY,o=process.env.FUNDER_ADDRESS,l=process.env.POLYGON_RPC_URL||"https://polygon-rpc.com",c=process.env.CLOB_API_URL||"https://clob.polymarket.com",d=!!t&&"0x_your_private_key_here"!==t&&t.length>10,p=!!o&&"0x_your_funder_address_here"!==o&&o.length>10;e.envVars={ok:d&&p,label:"Environment Variables",detail:d||p?d?p?"PRIVATE_KEY and FUNDER_ADDRESS configured":"FUNDER_ADDRESS missing from .env.local":"PRIVATE_KEY missing from .env.local":"PRIVATE_KEY and FUNDER_ADDRESS missing from .env.local"};let u="";try{let r=new s.StaticJsonRpcProvider(l,137),o=await Promise.race([r.getBlockNumber(),new Promise((e,t)=>setTimeout(()=>t(Error("timeout")),5e3))]);d&&(u=new i.Wallet(t,r).address),e.rpc={ok:!0,label:"Polygon RPC",detail:`Connected (block #${o}) � ${l.includes("polygon-rpc.com")?"? Public RPC (slow)":l.replace(/\/v2\/.*/,"/v2/***")}`}}catch(t){e.rpc={ok:!1,label:"Polygon RPC",detail:`Failed to connect to ${l.replace(/\/v2\/.*/,"/v2/***")}: ${t instanceof Error?t.message:t}`}}if(d&&p&&e.rpc.ok)try{let a=new s.StaticJsonRpcProvider(l,137),c=new i.Wallet(t,a),{Contract:d}=await Promise.resolve().then(r.t.bind(r,12792,23)),p=["function balanceOf(address) view returns (uint256)"],A=new d("0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174",p,a),m=new d("0x3c499c542cEF5E3811e1192ce70d8cC03d5c3359",p,a),S=[c.address];o&&o.toLowerCase()!==c.address.toLowerCase()&&S.push(o);let E=await Promise.race([Promise.all(S.flatMap(e=>[A.balanceOf(e).then(t=>({addr:e,token:"USDC.e",val:Number(t)/1e6})).catch(()=>({addr:e,token:"USDC.e",val:0})),m.balanceOf(e).then(t=>({addr:e,token:"USDC",val:Number(t)/1e6})).catch(()=>({addr:e,token:"USDC",val:0}))])),new Promise((e,t)=>setTimeout(()=>t(Error("timeout")),8e3))]),f=E.reduce((e,t)=>e+t.val,0);console.log(`[Setup] On-chain balances: ${E.map(e=>`${e.token}@${e.addr.slice(0,6)}=$${e.val.toFixed(2)}`).join(", ")}`);let C=0;try{let e=await Promise.race([(0,n.tS)(),new Promise(e=>setTimeout(()=>e(null),5e3))]);if(e){let t=await e.getBalanceAllowance({asset_type:"COLLATERAL"}),r=t?.balance||"0",o=parseFloat(r);C=o>1e6?o/1e6:o,console.log(`[Setup] Exchange balance raw="${r}" parsed=${C}`)}}catch{}let h=f+C,v=[];C>0&&v.push(`$${C.toFixed(2)} exchange`),f>0&&v.push(`$${f.toFixed(2)} on-chain`);let k=o?`${o.slice(0,6)}...${o.slice(-4)}`:`${u.slice(0,6)}...${u.slice(-4)}`;e.wallet={ok:!0,label:"Wallet",detail:h>0?`${k} | ${v.join(" + ")}`:`${k} | $0.00 available (funds may be in active positions)`}}catch(t){e.wallet={ok:!1,label:"Wallet",detail:`Could not read balance: ${t instanceof Error?t.message:t}`}}else e.wallet={ok:!1,label:"Wallet",detail:d?"RPC not connected":"No PRIVATE_KEY set"};try{let t=(0,n.YX)();await Promise.race([t.getOrderBook("0x0000000000000000000000000000000000000000000000000000000000000001"),new Promise((e,t)=>setTimeout(()=>t(Error("timeout")),5e3))]),e.clobRead={ok:!0,label:"CLOB API (read)",detail:`Connected to ${c}`}}catch(r){let t=r instanceof Error?r.message:String(r);t.includes("404")||t.includes("Not Found")||t.includes("400")?e.clobRead={ok:!0,label:"CLOB API (read)",detail:`Connected to ${c}`}:e.clobRead={ok:!1,label:"CLOB API (read)",detail:`Cannot reach ${c}: ${t}`}}if(d&&p)try{let t=await Promise.race([(0,n.tS)(),new Promise(e=>setTimeout(()=>e(null),8e3))]);e.clobAuth={ok:!!t,label:"CLOB API (auth)",detail:t?"Authenticated � API keys derived from wallet":"Failed � check PRIVATE_KEY and FUNDER_ADDRESS"}}catch(t){e.clobAuth={ok:!1,label:"CLOB API (auth)",detail:`Auth failed: ${t instanceof Error?t.message:t}`}}else e.clobAuth={ok:!1,label:"CLOB API (auth)",detail:"Skipped � env vars not set"};let A=e.envVars.ok&&e.rpc.ok&&e.wallet.ok&&e.clobAuth.ok;return a.NextResponse.json({success:!0,data:{steps:e,readyForLive:A,walletAddress:u||null}})}o()}catch(e){o(e)}})},43895:(e,t,r)=>{r.d(t,{k:()=>d});var o=r(94624),a=r.n(o),n=r(92048),s=r(55315);let i=process.env.LOG_FILE||(0,s.join)(process.cwd(),"data","bot.log"),l=process.env.LOG_LEVEL||"info",c=(0,s.dirname)(i);(0,n.existsSync)(c)||(0,n.mkdirSync)(c,{recursive:!0});let d=a().createLogger({level:l,format:a().format.combine(a().format.timestamp({format:"YYYY-MM-DD HH:mm:ss.SSS"}),a().format.printf(({timestamp:e,level:t,message:r,...o})=>{let a=Object.keys(o).length?` ${JSON.stringify(o)}`:"";return`[${e}] ${t.toUpperCase()}: ${r}${a}`})),transports:[new(a()).transports.Console({format:a().format.combine(a().format.colorize(),a().format.timestamp({format:"HH:mm:ss"}),a().format.printf(({timestamp:e,level:t,message:r})=>`[${e}] ${t}: ${r}`))}),new(a()).transports.File({filename:i,maxsize:10485760,maxFiles:5})]})},21925:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.d(t,{EG:()=>S,L4:()=>m,YX:()=>A,_e:()=>f,pQ:()=>E,tS:()=>u});var a=r(67332),n=r(47152),s=r(90399),i=r(99648),l=r(35240),c=r.n(l),d=r(43895),p=e([a,i]);[a,i]=p.then?(await p)():p;let C=new(c()).Agent({ciphers:"TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-RSA-AES128-SHA:ECDHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA:AES256-SHA",minVersion:"TLSv1.2",maxVersion:"TLSv1.3",keepAlive:!0});i.default.interceptors.request.use(e=>(e.headers["User-Agent"]="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36",e.headers.Accept="application/json, text/plain, */*",e.headers["Accept-Language"]="en-US,en;q=0.9",e.headers.Connection="keep-alive",e.httpAgent=e.httpAgent||C,e.httpsAgent=e.httpsAgent||C,e.timeout=e.timeout||5e3,e));let h=null,v=null,k=process.env.POLYGON_RPC_URL||"https://polygon-rpc.com";async function u(){if(h)return h;let e=process.env.PRIVATE_KEY,t=process.env.FUNDER_ADDRESS,r=process.env.CLOB_API_URL||"https://clob.polymarket.com",o=parseInt(process.env.CHAIN_ID||"137"),i=parseInt(process.env.SIGNATURE_TYPE||"0");if(!e||!t)return d.k.warn("No PRIVATE_KEY or FUNDER_ADDRESS set — live trading unavailable"),null;try{let l=new s.StaticJsonRpcProvider(k,137),c=new n.Wallet(e,l),p=process.env.CLOB_API_KEY,u=process.env.CLOB_SECRET,A=process.env.CLOB_PASSPHRASE;if(p&&u&&A)v={key:p,secret:u,passphrase:A},d.k.info("Using pre-configured CLOB API keys from .env");else{let e=new a.ClobClient(r,o,c,void 0,i,t);v=await e.createOrDeriveApiKey(),d.k.info("API keys derived from Polymarket")}return h=new a.ClobClient(r,o,c,v,i,t),d.k.info("CLOB client initialized successfully"),h}catch(e){return d.k.error(`Failed to initialize CLOB client: ${e}`),null}}function A(){let e=process.env.CLOB_API_URL||"https://clob.polymarket.com",t=parseInt(process.env.CHAIN_ID||"137");return new a.ClobClient(e,t)}async function m(e,t,r,o,n){let s=await u();if(!s)return{success:!1,error:"CLOB client not initialized"};try{let i=await s.createAndPostOrder({tokenID:e,price:t,side:a.Side.BUY,size:r,feeRateBps:void 0,nonce:void 0,expiration:void 0},{tickSize:o,negRisk:n});return d.k.info(`Buy order placed: ${r} shares @ $${t} | token=${e}`),{success:!0,orderId:i?.orderID||i?.orderIds?.[0]||"unknown"}}catch(t){let e=t instanceof Error?t.message:String(t);return d.k.error(`Buy order failed: ${e}`),{success:!1,error:e}}}async function S(e,t,r,o,n){let s=await u();if(!s)return{success:!1,error:"CLOB client not initialized"};try{let i=await s.createAndPostOrder({tokenID:e,price:t,side:a.Side.SELL,size:r,feeRateBps:void 0,nonce:void 0,expiration:void 0},{tickSize:o,negRisk:n});return d.k.info(`Sell order placed: ${r} shares @ $${t} | token=${e}`),{success:!0,orderId:i?.orderID||i?.orderIds?.[0]||"unknown"}}catch(t){let e=t instanceof Error?t.message:String(t);return d.k.error(`Sell order failed: ${e}`),{success:!1,error:e}}}async function E(e,t,r,o,n){let s=await u();if(!s)return{success:!1,error:"CLOB client not initialized"};try{let i=await s.createAndPostOrder({tokenID:e,price:t,side:a.Side.BUY,size:r,feeRateBps:void 0,nonce:void 0,expiration:void 0},{tickSize:o,negRisk:n},a.OrderType.GTC,!1,!0);return d.k.info(`[ARB] Limit buy placed: ${r.toFixed(2)} shares @ $${t} | token=${e}`),{success:!0,orderId:i?.orderID||i?.orderIds?.[0]||"unknown"}}catch(t){let e=t instanceof Error?t.message:String(t);return d.k.error(`[ARB] Limit buy failed: ${e}`),{success:!1,error:e}}}async function f(e){let t=await u();if(!t)return{success:!1,error:"CLOB client not initialized"};try{return await t.cancelOrders(e),d.k.info(`[ARB] Cancelled ${e.length} orders`),{success:!0}}catch(t){let e=t instanceof Error?t.message:String(t);return d.k.error(`[ARB] Batch cancel failed: ${e}`),{success:!1,error:e}}}o()}catch(e){o(e)}})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[948,70,624],()=>r(37097));module.exports=o})();