exports.id=337,exports.ids=[337],exports.modules={87529:()=>{},43895:(e,t,r)=>{"use strict";r.d(t,{k:()=>d});var n=r(94624),o=r.n(n),i=r(92048),s=r(55315);let a=process.env.LOG_FILE||(0,s.join)(process.cwd(),"data","bot.log"),c=process.env.LOG_LEVEL||"info",l=(0,s.dirname)(a);(0,i.existsSync)(l)||(0,i.mkdirSync)(l,{recursive:!0});let d=o().createLogger({level:c,format:o().format.combine(o().format.timestamp({format:"YYYY-MM-DD HH:mm:ss.SSS"}),o().format.printf(({timestamp:e,level:t,message:r,...n})=>{let o=Object.keys(n).length?` ${JSON.stringify(n)}`:"";return`[${e}] ${t.toUpperCase()}: ${r}${o}`})),transports:[new(o()).transports.Console({format:o().format.combine(o().format.colorize(),o().format.timestamp({format:"HH:mm:ss"}),o().format.printf(({timestamp:e,level:t,message:r})=>`[${e}] ${t}: ${r}`))}),new(o()).transports.File({filename:a,maxsize:10485760,maxFiles:5})]})},21925:(e,t,r)=>{"use strict";r.d(t,{EG:()=>m,L4:()=>f,YX:()=>p,_e:()=>y,pQ:()=>k,tS:()=>u});var n=r(32101),o=r(72019),i=r(78165),s=r(63813),a=r(43895);let c=null,l=null,d=process.env.POLYGON_RPC_URL||"https://polygon-rpc.com";async function u(){if(c)return c;let e=process.env.PRIVATE_KEY,t=process.env.FUNDER_ADDRESS,r=process.env.CLOB_API_URL||"https://clob.polymarket.com",o=parseInt(process.env.CHAIN_ID||"137"),u=parseInt(process.env.SIGNATURE_TYPE||"0");if(!e||!t)return a.k.warn("No PRIVATE_KEY or FUNDER_ADDRESS set â€” live trading unavailable"),null;try{let p=new s.c(d,137),f=new i.w5(e,p),m=process.env.CLOB_API_KEY,k=process.env.CLOB_SECRET,y=process.env.CLOB_PASSPHRASE;if(m&&k&&y)l={key:m,secret:k,passphrase:y},a.k.info("Using pre-configured CLOB API keys from .env");else{let e=new n.R(r,o,f,void 0,u,t);l=await e.createOrDeriveApiKey(),a.k.info("API keys derived from Polymarket")}return c=new n.R(r,o,f,l,u,t),a.k.info("CLOB client initialized successfully"),c}catch(e){return a.k.error(`Failed to initialize CLOB client: ${e}`),null}}function p(){let e=process.env.CLOB_API_URL||"https://clob.polymarket.com",t=parseInt(process.env.CHAIN_ID||"137");return new n.R(e,t)}async function f(e,t,r,n,i){let s=await u();if(!s)return{success:!1,error:"CLOB client not initialized"};try{let c=await s.createAndPostOrder({tokenID:e,price:t,side:o.MF.BUY,size:r,feeRateBps:void 0,nonce:void 0,expiration:void 0},{tickSize:n,negRisk:i});return a.k.info(`Buy order placed: ${r} shares @ $${t} | token=${e}`),{success:!0,orderId:c?.orderID||c?.orderIds?.[0]||"unknown"}}catch(t){let e=t instanceof Error?t.message:String(t);return a.k.error(`Buy order failed: ${e}`),{success:!1,error:e}}}async function m(e,t,r,n,i){let s=await u();if(!s)return{success:!1,error:"CLOB client not initialized"};try{let c=await s.createAndPostOrder({tokenID:e,price:t,side:o.MF.SELL,size:r,feeRateBps:void 0,nonce:void 0,expiration:void 0},{tickSize:n,negRisk:i});return a.k.info(`Sell order placed: ${r} shares @ $${t} | token=${e}`),{success:!0,orderId:c?.orderID||c?.orderIds?.[0]||"unknown"}}catch(t){let e=t instanceof Error?t.message:String(t);return a.k.error(`Sell order failed: ${e}`),{success:!1,error:e}}}async function k(e,t,r,n,i){let s=await u();if(!s)return{success:!1,error:"CLOB client not initialized"};try{let c=await s.createAndPostOrder({tokenID:e,price:t,side:o.MF.BUY,size:r,feeRateBps:void 0,nonce:void 0,expiration:void 0},{tickSize:n,negRisk:i},o.mr.GTC,!1,!0);return a.k.info(`[ARB] Limit buy placed: ${r.toFixed(2)} shares @ $${t} | token=${e}`),{success:!0,orderId:c?.orderID||c?.orderIds?.[0]||"unknown"}}catch(t){let e=t instanceof Error?t.message:String(t);return a.k.error(`[ARB] Limit buy failed: ${e}`),{success:!1,error:e}}}async function y(e){let t=await u();if(!t)return{success:!1,error:"CLOB client not initialized"};try{return await t.cancelOrders(e),a.k.info(`[ARB] Cancelled ${e.length} orders`),{success:!0}}catch(t){let e=t instanceof Error?t.message:String(t);return a.k.error(`[ARB] Batch cancel failed: ${e}`),{success:!1,error:e}}}},24979:(e,t,r)=>{"use strict";r.d(t,{$2:()=>S,E3:()=>h,bp:()=>I,rs:()=>v,up:()=>w});var n=r(24263),o=r(21925),i=r(43895),s=r(72019);let a=process.env.GAMMA_API_URL||"https://gamma-api.polymarket.com",c={BTC:"btc",ETH:"eth",SOL:"sol",XRP:"xrp"},l=new Map,d=new Map,u=0,p=[];async function f(e,t){let r=`${c[e]}-updown-15m-${t}`;try{let o=(await n.Z.get(`${a}/markets`,{params:{slug:r},timeout:5e3})).data;if(!o||!Array.isArray(o)||0===o.length)return null;let i=o[0],s=i.clobTokenIds?"string"==typeof i.clobTokenIds?JSON.parse(i.clobTokenIds):i.clobTokenIds:[];if(s.length<2)return null;return{conditionId:i.conditionId,slug:i.slug||r,question:i.question||`${e} 15m candle`,yesTokenId:s[0],noTokenId:s[1],endDate:i.endDate||i.endDateIso||"",endTimestamp:i.endDate?new Date(i.endDate).getTime()/1e3:t+900,active:!1!==i.active&&!i.closed,tickSize:i.orderPriceMinTickSize||"0.01",negRisk:!0===i.negRisk,asset:e}}catch{return null}}async function m(e){try{let t=(0,o.YX)(),r=await t.getMidpoints([{token_id:e.yesTokenId,side:s.MF.BUY},{token_id:e.noTokenId,side:s.MF.BUY}]),n=parseFloat(r?.[e.yesTokenId]||"0.5"),i=parseFloat(r?.[e.noTokenId]||"0.5");return{yesPrice:n,noPrice:i}}catch{return null}}async function k(e){let{current:t,prev:r}=function(){let e=900*Math.floor(Math.floor(Date.now()/1e3)/900);return{current:e,prev:e-900}}();await Promise.all(e.map(async e=>{for(let n of[t,r]){let t=await f(e,n);if(!t||!t.active)continue;let r=await m(t),o=Math.max(0,n+900-Math.floor(Date.now()/1e3));if(r&&o>0){let n={asset:e,conditionId:t.conditionId,slug:t.slug,yesTokenId:t.yesTokenId,noTokenId:t.noTokenId,yesPrice:r.yesPrice,noPrice:r.noPrice,combinedCost:r.yesPrice+r.noPrice,secondsRemaining:o,market:t,tickSize:t.tickSize,negRisk:t.negRisk};l.set(e,n);break}}}));let n=Date.now(),o=JSON.stringify(e)!==JSON.stringify(p);(n-u>5e3||o)&&(u=n,p=[...e],y(e).catch(()=>{}))}async function y(e){let t=900*Math.floor(Math.floor(Date.now()/1e3)/900),r=[];for(let n of e){let e=c[n];for(let n=1;n<=10;n++){let o=t-900*n,i=`${e}-updown-15m-${o}`,s=d.get(i);s&&"pending"!==s.result||r.push((async()=>{try{let e=await g(i),t=new Date((o+900)*1e3);d.set(i,{slug:i,timestamp:o,result:e,endTime:t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})}catch{}})())}}await Promise.all(r)}async function g(e){try{let t=(await n.Z.get(`${a}/markets`,{params:{slug:e},timeout:5e3})).data;if(!t?.[0])return"pending";let r=t[0];if(!0===r.active&&!r.closed)return"pending";if(r.outcomePrices)try{let e;if("string"==typeof r.outcomePrices)try{let t=JSON.parse(r.outcomePrices);e=Array.isArray(t)?t.map(Number):r.outcomePrices.split(",").map(Number)}catch{e=r.outcomePrices.split(",").map(Number)}else e=Array.isArray(r.outcomePrices)?r.outcomePrices.map(Number):[];if(e.length>=2&&!e.some(isNaN)){if(e[0]>e[1])return"up";if(e[1]>e[0])return"down"}}catch{}let i=r.clobTokenIds?"string"==typeof r.clobTokenIds?JSON.parse(r.clobTokenIds):r.clobTokenIds:[];if(i.length>=2)try{let e=(0,o.YX)(),t=await e.getMidpoints([{token_id:i[0],side:s.MF.BUY},{token_id:i[1],side:s.MF.BUY}]),r=parseFloat(t?.[i[0]]||"0"),n=parseFloat(t?.[i[1]]||"0");if(r>.9)return"up";if(n>.9)return"down"}catch{}return"pending"}catch{return"pending"}}function I(e){let t=900*Math.floor(Math.floor(Date.now()/1e3)/900),r=[],n=e&&e.length>0?e.map(e=>c[e]):Object.values(c);for(let e=1;e<=10;e++){let o=t-900*e;for(let e of n){let t=`${e}-updown-15m-${o}`,n=d.get(t);if(n){r.push(n);break}}}return r}function w(e){k(e).catch(e=>{i.k.error(`[Scanner] Initial scan failed: ${e}`)}),setInterval(()=>{k(e).catch(e=>{i.k.error(`[Scanner] Scan failed: ${e}`)})},5e3),i.k.info(`[Scanner] Started for assets: ${e.join(", ")}`)}function h(e,t){let r=d.get(e);if(r)r.result=t;else{let r=parseInt(e.split("-").pop()||"0",10),n=new Date((r+900)*1e3);d.set(e,{slug:e,timestamp:r,result:t,endTime:n.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})}}function S(){let e=Math.floor(Date.now()/1e3);return Array.from(l.values()).map(t=>{let r=parseInt(t.slug.split("-").pop()||"0",10);return{...t,secondsRemaining:Math.max(0,r+900-e)}})}function v(e){return l.get(e)||null}}};